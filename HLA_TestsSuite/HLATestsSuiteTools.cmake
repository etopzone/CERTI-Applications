
INCLUDE(MacroTools.cmake)
ENABLE_TESTING()

MACRO(HLATestsSuite_ADD_TEST)
    PARSE_ARGUMENTS(HLATSTools "FED_FILE;SOURCE_FILES;DTEST_SCRIPT;COMMENTS" "VERBOSE" ${ARGN})          
    CAR(TESTNAME ${HLATSTools_DEFAULT_ARGS})       
    MESSAGE(STATUS "Configuring HLA Test: ${TESTNAME}")
    IF (HLATSTools_VERBOSE)     
       MESSAGE(STATUS "       FED_FILE = ${HLATSTools_FED_FILE}")
       MESSAGE(STATUS "   SOURCE_FILES = ${HLATSTools_SOURCE_FILES}")
       MESSAGE(STATUS "   DTEST_SCRIPT = ${HLATSTools_DTEST_SCRIPT}")
       MESSAGE(STATUS "       COMMENTS = ${HLATSTools_COMMENTS}")
    ENDIF(HLATSTools_VERBOSE)
    ADD_EXECUTABLE(${TESTNAME} ${HLATSTools_SOURCE_FILES})    
    TARGET_LINK_LIBRARIES (${TESTNAME} ${CERTI_LIBRARIES})    
    INSTALL(TARGETS ${TESTNAME} 
            RUNTIME DESTINATION bin)
    INSTALL(FILES ${HLATSTools_FED_FILE}
            DESTINATION share/federations)
    IF(HLATSTools_DTEST_SCRIPT)
        CONFIGURE_FILE(${HLATSTools_DTEST_SCRIPT} ${HLATSTools_DTEST_SCRIPT} COPYONLY)
        ADD_TEST(${TESTNAME} ${HLATSTools_DTEST_SCRIPT}) 
    ENDIF(HLATSTools_DTEST_SCRIPT)
ENDMACRO(HLATestsSuite_ADD_TEST)
